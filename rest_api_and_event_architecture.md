### REST API, ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ ë¹„êµ

.. ë©´ì ‘ ì¤€ë¹„ í•˜ëŠ”ë° ì´ë²¤íŠ¸ ê¸°ë°˜ ì²˜ë¦¬ì— ëŒ€í•œ ê°œë…ì´ í–‡ê°ˆë ¤ì„œ ì •ë¦¬í•¨;;; (feat. chatGPT)

---

### âœ… ìƒí™© ê°€ì •: íšŒì›ê°€ì… ì²˜ë¦¬

**íšŒì›ê°€ì… ì‹œ í•„ìš”í•œ ì‘ì—… ì˜ˆì‹œ**
1. ê³„ì •ì •ë³´ DB ì €ì¥
2. ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ ì´ë¯¸ì§€ CDN ì„œë²„ì— ì—…ë¡œë“œ
3. ì´ë¯¸ì§€ URL ìƒì„± ë° ì €ì¥
4. í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µ ë°˜í™˜

---

### âœ… ì „í†µì ì¸ REST API ë°©ì‹

- í´ë¼ì´ì–¸íŠ¸ â†’ `POST /signup`
- ì„œë²„ëŠ” ìœ„ì˜ 1~4ë²ˆ **ëª¨ë“  ì‘ì—…ì„ ìˆœì°¨ì ìœ¼ë¡œ ìˆ˜í–‰**
- í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì „ì²´ ì‹¤íŒ¨ (`500` ë˜ëŠ” `400` ì‘ë‹µ)

### íë¦„ ì˜ˆì‹œ:

```text
ìš”ì²­
 â†“
1. DB ì €ì¥
 â†“
2. ì´ë¯¸ì§€ ì—…ë¡œë“œ
 â†“
3. ì´ë¯¸ì§€ URL ìƒì„±
 â†“
4. ì‘ë‹µ ë°˜í™˜
```

- âœ… ì¥ì : êµ¬í˜„ì´ ì§ê´€ì ì´ê³  ì´í•´í•˜ê¸° ì‰¬ì›€
- âŒ ë‹¨ì :
    - ì¤‘ê°„ì— ì‹¤íŒ¨í•˜ë©´ ì „ì²´ ì‹¤íŒ¨ ì²˜ë¦¬ë¨
    - ì‘ë‹µì´ ëŠë¦´ ìˆ˜ ìˆìŒ
    - ì‘ì—… ê°„ ê²°í•©ë„ê°€ ë†’ìŒ (tightly coupled)

---

## âœ… ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ ë°©ì‹

- í´ë¼ì´ì–¸íŠ¸ â†’ `POST /signup`
- ì„œë²„ëŠ” 1ë²ˆ(ê³„ì •ì •ë³´ ì €ì¥)ë§Œ ìˆ˜í–‰í•˜ê³  **ì¦‰ì‹œ ì‘ë‹µ ë°˜í™˜**
- `user.created`ë¼ëŠ” ì´ë²¤íŠ¸ë¥¼ ë°œí–‰(publish)í•¨
- ì´í›„ ì‘ì—…ì€ í•´ë‹¹ ì´ë²¤íŠ¸ë¥¼ êµ¬ë…(subscribe)í•˜ëŠ” ëª¨ë“ˆë“¤ì´ ì²˜ë¦¬

### íë¦„ ì˜ˆì‹œ:
```text
ìš”ì²­
â†“
DB ì €ì¥
â†“
ì‘ë‹µ ë°˜í™˜ (ë¹ ë¦„)
â†“
'User Created' ì´ë²¤íŠ¸ ë°œí–‰
â†“
[ì´ë¯¸ì§€ ì—…ë¡œë” ì›Œì»¤]
[URL ìƒì„±ê¸° ì›Œì»¤]
[ì´ë©”ì¼ ë°œì†¡ê¸° ì›Œì»¤]
```



- âœ… ì¥ì :
    - ë¹ ë¥¸ ì‘ë‹µ
    - ì‘ì—… ê°„ ê²°í•©ë„ ë‚®ìŒ (loosely coupled)
    - ë‚˜ì¤‘ì— ì‘ì—… ì¶”ê°€ ì‹œ API ìˆ˜ì • ì—†ì´ ì´ë²¤íŠ¸ êµ¬ë…ìë§Œ ì¶”ê°€
- âš ï¸ ë‹¨ì :
    - ì„¤ê³„ê°€ ìƒëŒ€ì ìœ¼ë¡œ ë³µì¡í•  ìˆ˜ ìˆìŒ
    - ë¶„ì‚° í™˜ê²½ì— ìµìˆ™í•˜ì§€ ì•Šìœ¼ë©´ ë””ë²„ê¹… ì–´ë ¤ì›€

---

## âœ… í•µì‹¬ ë¹„êµ ìš”ì•½

| í•­ëª© | REST API ë°©ì‹ | ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ |
|------|----------------|------------------------|
| ì²˜ë¦¬ ë°©ì‹ | ëª¨ë“  ì‘ì—…ì„ API ì•ˆì—ì„œ ì²˜ë¦¬ | í•µì‹¬ ì‘ì—…ë§Œ ì²˜ë¦¬ í›„ ì´ë²¤íŠ¸ ë°œí–‰ |
| ì‹¤íŒ¨ ì‹œ ì˜í–¥ | ì¤‘ê°„ ì‹¤íŒ¨ â†’ ì „ì²´ ì‹¤íŒ¨ | ê°œë³„ ì‹¤íŒ¨ëŠ” ì „ì²´ì™€ ë¬´ê´€ |
| ì‘ë‹µ ì†ë„ | ìƒëŒ€ì ìœ¼ë¡œ ëŠë¦¼ | ë¹ ë¦„ |
| í™•ì¥ì„± | ë‚®ìŒ (API ì½”ë“œ ìˆ˜ì • í•„ìš”) | ë†’ìŒ (ë¦¬ìŠ¤ë„ˆë§Œ ì¶”ê°€í•˜ë©´ ë¨) |
| ê²°í•©ë„ | ë†’ìŒ (tightly coupled) | ë‚®ìŒ (loosely coupled) |
| ìœ ì—°ì„± | ì‘ì—… ìˆœì„œ ê³ ì • | ë³‘ë ¬ ì²˜ë¦¬ ë° ì¬ì‚¬ìš© ê°€ëŠ¥ |

---

## âœ… ìš”ì•½

> **REST API ë°©ì‹**ì€ ëª¨ë“  ì²˜ë¦¬ê°€ í•œ ìš”ì²­ ì•ˆì—ì„œ ì´ë£¨ì–´ì§€ê³ , í•˜ë‚˜ë¼ë„ ì‹¤íŒ¨í•˜ë©´ ì „ì²´ ì‹¤íŒ¨ê°€ ë©ë‹ˆë‹¤.  
> ë°˜ë©´, **ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜**ëŠ” í•µì‹¬ ë¡œì§ë§Œ ì²˜ë¦¬í•˜ê³  ë‚˜ë¨¸ì§€ëŠ” ì´ë²¤íŠ¸ì— ë°˜ì‘í•˜ëŠ” êµ¬ì¡°ë¡œ ë¶„ë¦¬ë˜ì–´ ìœ ì—°í•˜ê³  í™•ì¥ì„±ì´ ë›°ì–´ë‚©ë‹ˆë‹¤.

> ë‹¹ì‹ ì´ ë§í•œ:
>
> > â€œREST APIëŠ” ì „ì²´ ì‘ì—…ì´ ë‹¤ ëë‚˜ì•¼ ì„±ê³µ,  
> > ì´ë²¤íŠ¸ ê¸°ë°˜ì€ í•µì‹¬ë§Œ í•˜ê³  ë‚˜ë¨¸ì§„ ë”°ë¡œ ì²˜ë¦¬â€
>
> â†’ ì´ê±´ ì´ë²¤íŠ¸ ê¸°ë°˜ ì‹œìŠ¤í…œì„ ì§ê´€ì ìœ¼ë¡œ ì™„ë²½í•˜ê²Œ ì„¤ëª…í•œ í‘œí˜„ì…ë‹ˆë‹¤ ğŸ¯

---

#### â“ Q: í•µì‹¬ë§Œ ì²˜ë¦¬í•˜ê³  ë‚˜ë¨¸ì§„ ë”°ë¡œ ì²˜ë¦¬í•œë‹¤ê°€ ì´ë²¤íŠ¸ë©´ Java Spring ì—ì„œ ë³„ë„ ìŠ¤ë ˆë“œ ì²˜ë¦¬í•´ë„ ì´ë²¤íŠ¸ ê¸°ë°˜ì„?

> ì˜ˆ: `/signup` API ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ë•Œ
> 1. ê³„ì • ìƒì„±ì€ `UserService.createUser()`ì—ì„œ ì²˜ë¦¬
> 2. ì´ë¯¸ì§€ ì—…ë¡œë“œë‚˜ ì´ë©”ì¼ ë°œì†¡ ê°™ì€ ë¶€ê°€ ì‘ì—…ì€ ë³„ë„ì˜ ìŠ¤ë ˆë“œë¡œ ì²˜ë¦¬ (`new Thread`, `CompletableFuture.runAsync()` ë“±)
>
> ì´ êµ¬ì¡°ë„ ì´ë²¤íŠ¸ ê¸°ë°˜ ì²˜ë¦¬ë¼ê³  ë´ì•¼í•¨?

---

### âœ… ê²°ë¡ ë¶€í„° ë§í•˜ë©´:

> âŒ **ì´ê±´ ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜ë¼ê³  ë³´ê¸´ ì–´ë µìŠµë‹ˆë‹¤.**  
> âœ… **ë‹¨ì§€ ë¹„ë™ê¸° ì²˜ë¦¬(asynchronous processing)ì¼ ë¿ì…ë‹ˆë‹¤.**

---

### ğŸ” ë¹„êµ: ë¹„ë™ê¸° ì²˜ë¦¬ vs ì´ë²¤íŠ¸ ê¸°ë°˜ ì²˜ë¦¬

| í•­ëª© | ë¹„ë™ê¸° ì²˜ë¦¬ | ì´ë²¤íŠ¸ ê¸°ë°˜ ì²˜ë¦¬ |
|------|-------------|------------------|
| ì˜ˆì‹œ | `new Thread`, `CompletableFuture.runAsync()` | `@EventListener`, Kafka, RabbitMQ |
| ë™ì‘ ë°©ì‹ | íŠ¹ì • ë¡œì§ì„ ë¹„ë™ê¸°ë¡œ ì‹¤í–‰ | ì´ë²¤íŠ¸ ê°ì²´ë¥¼ ë°œí–‰í•˜ê³ , ì—¬ëŸ¬ ë¦¬ìŠ¤ë„ˆê°€ ë°˜ì‘ |
| ê²°í•©ë„ | ìƒëŒ€ì ìœ¼ë¡œ ë†’ìŒ (í•¨ìˆ˜ í˜¸ì¶œ ëª…ì‹œë¨) | ë‚®ìŒ (ë°œí–‰ìì™€ ìˆ˜ì‹ ì ë¶„ë¦¬ë¨) |
| ëª©ì  | ì‘ë‹µ ì†ë„ í–¥ìƒ, ì²˜ë¦¬ ë¶„ë¦¬ | í™•ì¥ì„±ê³¼ ëŠìŠ¨í•œ ê²°í•©, ë¶„ì‚° ì²˜ë¦¬ |
| ì•„í‚¤í…ì²˜ íŠ¹ì„± | ì½”ë“œ êµ¬ì¡°ë§Œ ë¹„ë™ê¸° | êµ¬ì¡°ì  ì•„í‚¤í…ì²˜ íŒ¨í„´ (Publish / Subscribe) |

---

### âœ… ì˜ˆì‹œ 1: ë‹¨ìˆœ ë¹„ë™ê¸° ì²˜ë¦¬ (ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„ë‹˜)

```java
@PostMapping("/signup")
public ResponseEntity<?> signup(@RequestBody UserDto userDto) {
    userService.createUser(userDto); // 1. ê³„ì • ì €ì¥

    // 2. ë¹„ë™ê¸° ì²˜ë¦¬ (í•˜ì§€ë§Œ ì´ë²¤íŠ¸ëŠ” ì•„ë‹˜)
    CompletableFuture.runAsync(() -> {
        imageService.uploadToCDN(userDto.getProfileImage());
        emailService.sendWelcomeEmail(userDto.getEmail());
    });

    return ResponseEntity.ok("íšŒì›ê°€ì… ì™„ë£Œ");
}
```

### âœ… ì˜ˆì‹œ 2: Springì˜ ì´ë²¤íŠ¸ ê¸°ë°˜ êµ¬ì¡°

```java
// 1. ì´ë²¤íŠ¸ ì •ì˜
public class UserCreatedEvent extends ApplicationEvent {
    private final User user;
    public UserCreatedEvent(User user) {
        super(user);
        this.user = user;
    }
}

// 2. ì´ë²¤íŠ¸ ë°œí–‰
userService.createUser(userDto);
applicationEventPublisher.publishEvent(new UserCreatedEvent(user));

// 3. ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
@EventListener
public void handleUserCreated(UserCreatedEvent event) {
    imageService.uploadToCDN(event.getUser().getProfileImage());
    emailService.sendWelcomeEmail(event.getUser().getEmail());
}
```